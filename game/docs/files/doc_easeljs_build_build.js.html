<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>doc/easeljs/build/build.js - Notebook Numbers</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="Notebook Numbers"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.0.3</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/AlphaMapFilter.html">AlphaMapFilter</a></li>
            
                <li><a href="../classes/AlphaMaskFilter.html">AlphaMaskFilter</a></li>
            
                <li><a href="../classes/Bitmap.html">Bitmap</a></li>
            
                <li><a href="../classes/BitmapAnimation.html">BitmapAnimation</a></li>
            
                <li><a href="../classes/BoxBlurFilter.html">BoxBlurFilter</a></li>
            
                <li><a href="../classes/Cell.html">Cell</a></li>
            
                <li><a href="../classes/ColorFilter.html">ColorFilter</a></li>
            
                <li><a href="../classes/ColorMatrix.html">ColorMatrix</a></li>
            
                <li><a href="../classes/ColorMatrixFilter.html">ColorMatrixFilter</a></li>
            
                <li><a href="../classes/Command.html">Command</a></li>
            
                <li><a href="../classes/Container.html">Container</a></li>
            
                <li><a href="../classes/Cursor.html">Cursor</a></li>
            
                <li><a href="../classes/DisplayObject.html">DisplayObject</a></li>
            
                <li><a href="../classes/DOMElement.html">DOMElement</a></li>
            
                <li><a href="../classes/EaselJS.html">EaselJS</a></li>
            
                <li><a href="../classes/EventDispatcher.html">EventDispatcher</a></li>
            
                <li><a href="../classes/Filter.html">Filter</a></li>
            
                <li><a href="../classes/Graphics.html">Graphics</a></li>
            
                <li><a href="../classes/Grid.html">Grid</a></li>
            
                <li><a href="../classes/Log.html">Log</a></li>
            
                <li><a href="../classes/Matrix2D.html">Matrix2D</a></li>
            
                <li><a href="../classes/MouseEvent.html">MouseEvent</a></li>
            
                <li><a href="../classes/MovieClip.html">MovieClip</a></li>
            
                <li><a href="../classes/MovieClipPlugin.html">MovieClipPlugin</a></li>
            
                <li><a href="../classes/NotebookNumbers.html">NotebookNumbers</a></li>
            
                <li><a href="../classes/Point.html">Point</a></li>
            
                <li><a href="../classes/Rectangle.html">Rectangle</a></li>
            
                <li><a href="../classes/Shadow.html">Shadow</a></li>
            
                <li><a href="../classes/Shape.html">Shape</a></li>
            
                <li><a href="../classes/SpriteSheet.html">SpriteSheet</a></li>
            
                <li><a href="../classes/SpriteSheetBuilder.html">SpriteSheetBuilder</a></li>
            
                <li><a href="../classes/SpriteSheetUtils.html">SpriteSheetUtils</a></li>
            
                <li><a href="../classes/Stage.html">Stage</a></li>
            
                <li><a href="../classes/Text.html">Text</a></li>
            
                <li><a href="../classes/Ticker.html">Ticker</a></li>
            
                <li><a href="../classes/Touch.html">Touch</a></li>
            
                <li><a href="../classes/UID.html">UID</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/EaselJS.html">EaselJS</a></li>
            
                <li><a href="../modules/NotebookNumbers.html">NotebookNumbers</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: doc/easeljs/build/build.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
#!/usr/bin/env node
// TODO: add support for recursively checking to see if we are ommiting any files

var FILE = require(&quot;fs&quot;);
var PATH = require(&quot;path&quot;);
var CHILD_PROCESS = require(&quot;child_process&quot;);
var OS = require(&quot;os&quot;);

//file system utils
var WRENCH = require(&quot;wrench&quot;);

//for parsing command line args
var OPTIMIST = require(&quot;optimist&quot;);

/************************************************************
CONFIGURATION
*/

var json = FILE.readFileSync(PATH.resolve(&quot;./config.json&quot;), &quot;UTF-8&quot;);
json = JSON.parse(json);
var config =json.config_easeljs;

var SOURCE_FILES = [];
// listing of all source files, with dependencies listed in order:
SOURCE_FILES = config.SOURCE_FILES;

// default name for lib output:
var JS_FILE_NAME = config.JS_FILE_NAME;
// project name:
var PROJECT_NAME = config.PROJECT_NAME;

// url for website or github repo for project:
var PROJECT_URL = config.PROJECT_URL;

// name of directory for docs:
var DOCS_DIR_NAME =  PROJECT_NAME + config.DOCS_DIR_NAME;

// name of file for zipped docs:
var DOCS_FILE_NAME = DOCS_DIR_NAME + config.DOCS_FILE_NAME

// name of directory where generated files are placed
var OUTPUT_DIR_NAME = __dirname + config.OUTPUT_DIR_NAME;

// path to directory that includes YUI Doc templates
var TEMPLATE_DIR_PATH = __dirname + config.TEMPLATE_DIR_PATH;

// tmp directory used when running scripts:
var TMP_DIR_NAME = __dirname + config.TMP_DIR_NAME;

// paths to tools:
var GOOGLE_CLOSURE_PATH = PATH.resolve(&quot;../&quot;+PATH.normalize(config.GOOGLE_CLOSURE_PATH))

/*
END CONFIGURATION
************************************************************/
OPTIMIST
	.describe(&quot;l&quot;, &quot;List all available tasks&quot;)
	.alias(&quot;l&quot;, &quot;list&quot;)
	.boolean(&quot;l&quot;)
	.describe(&quot;h&quot;, &quot;Display usage&quot;)
	.alias(&quot;h&quot;, &quot;help&quot;)
	.boolean(&quot;h&quot;)
	.describe(&quot;version&quot;, &quot;Build version number (x.x.x) defaults &#x27;NEXT&#x27;&quot;)
	.string(&quot;version&quot;)
    .default(&quot;version&quot;, &quot;NEXT&quot;)
    .describe(&quot;tasks&quot;, &quot;Task to run options: [ALL, BUILDDOCS, BUILDSOURCE, CLEAN]&quot;)
	.default(&quot;tasks&quot;, &quot;ALL&quot;)
    .describe(&quot;format&quot;,  &quot;Formatting minified JS :[STANDARD, PRETTY_PRINT]&quot;)
    .string(&quot;format&quot;)
    .default(&quot;format&quot;, &quot;STANDARD&quot;)
    .usage(&quot;Build Task Manager for &quot;+PROJECT_NAME+&quot;\nUsage\n$0 [-h] [-l] --tasks=TASK [--version=DOC_VERSION] [--format=STANDARD]&quot;);

//name of minified js file.
var js_file_name = JS_FILE_NAME;

var version;
var verbose;
var format;

var TASK = {
	ALL:&quot;ALL&quot;,
	BUILDDOCS:&quot;BUILDDOCS&quot;,
	BUILDSOURCE:&quot;BUILDSOURCE&quot;,
	CLEAN:&quot;CLEAN&quot;
};

var extraSourceFiles;

//main entry point for script. Takes optimist argv object which
//contains command line arguments.
//This function is called at the bottom of the script
function main(argv)
{
	if(argv.h || argv.help)
	{
		displayUsage();
		process.exit(0);
	}

	if(argv.l || argv.list)
	{
		displayTasks();
		process.exit(0);
	}

	//default doesn&#x27;t seem to be working for OPTIMIST right now
	//if task is not specified, we default to ALL
	var task = (!argv.tasks)?&quot;ALL&quot;:argv.tasks.toUpperCase();
    format = (!argv.format)? &quot;STANDARD&quot; : argv.format.toUpperCase() ;
    
	if(!taskIsRecognized(task))
	{
		print(setColorText(&quot;Unrecognized task : &quot; + task, &quot;red&quot;));
		displayUsage();
		process.exit(1);
	}

	version = argv.version || &quot;NEXT&quot;;
    var type = OS.type().toLowerCase();
	if (type.indexOf(&quot;windows&quot;) != -1) {
        os = type;
    } else if (type.indexOf(&quot;darwin&quot;) != -1) {
        os = type;
    }
	
	if(argv.o)
	{
		js_file_name = argv.o;
	}

	var shouldBuildSource = (task == TASK.BUILDSOURCE);
	var shouldBuildDocs = (task == TASK.BUILDDOCS);
    
	if(task==TASK.CLEAN)
	{
		cleanTask(
			function(success)
			{
				print(setColorText(&quot;Clean Task Completed&quot;, &quot;green&quot;));
			}
		);
	}

	if(task == TASK.ALL)
	{	
		shouldBuildSource = true;
		shouldBuildDocs = true;
	}

	if(shouldBuildDocs &amp;&amp; (version == undefined))
	{
		displayUsage();
		process.exit(0);
	}
    
	if(shouldBuildSource)
	{
		buildSourceTask(function(success)
		{		
			print(setColorText(&quot;\nBuild Source Task Complete&quot;, &quot;green&quot;));
			if(shouldBuildDocs)
			{
				buildDocsTask(version,
					function(success)
					{
						print(setColorText(&quot;Build Docs Task Complete&quot;, &quot;green&quot;));
					}
				);
			}

		});
	}

	if(shouldBuildDocs &amp;&amp; task != &quot;ALL&quot;)
	{
		buildDocsTask(version,
			function(success)
			{
				print(setColorText(&quot;Build Docs Task Complete&quot;,&quot;green&quot;));
			}
		);
	}	
}


/********** TASKS *************/


function cleanTask(completeHandler)
{                                         
	if(FILE.existsSync(TMP_DIR_NAME))
	{	
		WRENCH.rmdirSyncRecursive(TMP_DIR_NAME);
	}
	  
	if(FILE.existsSync(OUTPUT_DIR_NAME))  
	{
		WRENCH.rmdirSyncRecursive(OUTPUT_DIR_NAME);
	}
}

function buildSourceTask(completeHandler)
{	        
	if(!FILE.existsSync(OUTPUT_DIR_NAME))
	{
		FILE.mkdirSync(OUTPUT_DIR_NAME);
	}
    
	js_file_name = js_file_name.split(&quot;%VERSION%&quot;).join(version);

	var file_args = [];
	var len = SOURCE_FILES.length;
	for(var i = 0; i &lt; len; i++)
	{
		file_args.push(&quot;--js&quot;);
        
        var dirName = &#x27;&quot;&#x27;+PATH.resolve(__dirname + SOURCE_FILES[i])+&#x27;&quot;&#x27;;
		var pattern = /[\w.\/% ]+version.js/g;
        var result = pattern.test(dirName);
        
        if (result) {
            var versionData = FILE.readFileSync(PATH.resolve(__dirname + SOURCE_FILES[i]), &quot;UTF-8&quot;); 
            pattern = /\/\*version\*\/&quot;([\w.]+)&quot;/g;
            var hasVersionFile = pattern.test(versionData);
            if (hasVersionFile) {
                var updateValues = {date:new Date().toUTCString(), version:version};
                updatedVersionData = replaceMetaData(versionData, updateValues);
                
                if (updatedVersionData.length != 0 || updatedVersionData != null || updatedVersionData != &quot;&quot;) { 
                    FILE.writeFileSync(PATH.resolve(__dirname + SOURCE_FILES[i]), updatedVersionData, &quot;UTF-8&quot;);
                } else {
                    console.log(setColorText(&quot;Error -- updating version.js&quot;,&quot;red&quot;));
                }
                
            }
        }
        
        file_args.push(dirName);
	}
	
	var tmp_file = &#x27;&quot;&#x27;+PATH.join(OUTPUT_DIR_NAME,&quot;tmp.js&quot;)+&#x27;&quot;&#x27;;
	var final_file = PATH.join(OUTPUT_DIR_NAME, js_file_name);
	
	GOOGLE_CLOSURE_PATH = &#x27;&quot;&#x27;+GOOGLE_CLOSURE_PATH+&#x27;&quot;&#x27;;
    var cmd;
	if (format == &quot;STANDARD&quot;) {
        cmd = [
            &quot;java&quot;, &quot;-jar&quot;, GOOGLE_CLOSURE_PATH
        ].concat(
			file_args
                ).concat(
                    [&quot;--js_output_file&quot;, tmp_file]
                );
    } else if (format == &quot;PRETTY_PRINT&quot;) {
        cmd = [ &quot;java&quot;, &quot;-jar&quot;, GOOGLE_CLOSURE_PATH ].concat(file_args).concat([&quot;--js_output_file&quot;, tmp_file]).concat([&quot;--formatting&quot;, &quot;PRETTY_PRINT&quot;]).concat([&quot;--compilation_level&quot;, &quot;WHITESPACE_ONLY&quot;]);	
    } 
    
    CHILD_PROCESS.exec(
		cmd.join(&quot; &quot;),
		function(error, stdout, stderr)
		{

		    if (error !== null)
			{
				print(setColorText(&quot;Error Running Google Closure : &quot; + error, &quot;red&quot;));
				exitWithFailure();
		    }
		
			var license_data = FILE.readFileSync(__dirname + &quot;/license.txt&quot;, &quot;UTF-8&quot;);
			var path = tmp_file.substring(1, tmp_file.length-1);
			var final_data = FILE.readFileSync(path, &quot;UTF-8&quot;);
				
			FILE.writeFileSync(final_file, license_data + final_data, &quot;UTF-8&quot;);

			FILE.unlinkSync(path);
			
			completeHandler(true);
		}
	);
}

function buildDocsTask(version, completeHandler)
{	
    if(!FILE.existsSync(OUTPUT_DIR_NAME))
	{
		FILE.mkdirSync(OUTPUT_DIR_NAME);
	}
    
	var parser_in=&quot;../src&quot;;
	var	parser_out= PATH.join(TMP_DIR_NAME , &quot;parser&quot;);

	var doc_dir=DOCS_DIR_NAME.split(&quot;%VERSION%&quot;).join(version);
	var doc_file=DOCS_FILE_NAME.split(&quot;%VERSION%&quot;).join(version);
	
	var generator_out=PATH.join(OUTPUT_DIR_NAME, doc_dir);

	var zipCommand = &quot;&quot;;
    var yuidocCommand = [&quot;yuidoc -q --themedir ./createjsTheme --outdir &quot;+&quot;./output/&quot;+doc_dir+&quot; --project-version&quot;, version];
    var type = OS.type().toLowerCase();
    if(type.indexOf(&quot;windows&quot;) != -1){  
		//If 7zip.exe is currently with the /build directory.
		zipCommand = &quot;..\\tools\\7-Zip\\7z a &quot;+&quot;output\\&quot;+doc_file+&quot; &quot;+&quot;output\\&quot;+ doc_dir +&quot; &gt; %temp%\\7z-log.txt&quot;;
	} else {
		zipCommand = &quot;cd ./output;zip -rq &quot; + doc_file + &quot; &quot; + &quot;&quot;+doc_dir+&quot;   &quot; + &quot;*.DS_Store&quot;;
	}
    
    CHILD_PROCESS.exec(
		yuidocCommand.join(&quot; &quot;),
		function(error, stdout, stderr)
		{

		    if (error !== null)
			{
				print(setColorText(&quot;Error Running YUI DOC : &quot; + error, &quot;red&quot;));
				exitWithFailure();
		    }
		
			CHILD_PROCESS.exec(
				zipCommand,
				function(error, stdout, stderr)
				{

				    if (error !== null)
					{
						print(setColorText(&quot;Error ZIPPING Docs :&quot; + error, &quot;red&quot;));
						exitWithFailure();
				    }
					completeHandler(true);				
				});		
		});
}

/*************** some util methods ******************/

function setColorText(str, color) {
    var type = color.toLowerCase();
    var colorStr = &quot;&quot;
    switch(type) {
        case &quot;red&quot;:
            colorStr = &quot;\033[31m&quot;+str+&quot;\033[0m&quot;;
            break;
        case &quot;green&quot;:
            colorStr = &quot;\033[32m&quot;+str+&quot;\033[0m&quot;;
            break;
        case &quot;blue&quot;:
            colorStr = &quot;\033[34m&quot;+str+&quot;\033[0m&quot;
            break;
        case &quot;magenta&quot;:
            colorStr = &quot;\033[35m&quot;+str+&quot;\033[0m&quot;
            break;
        case &quot;white&quot;:
            colorStr = &quot;\033[37m&quot;+str+&quot;\033[0m&quot;
            break;
        case &quot;cyan&quot;:
            colorStr = &quot;\033[36m&quot;+str+&quot;\033[0m&quot;;
            break;
        case &quot;yellow&quot;:
            colorStr = &quot;\033[33m&quot;+str+&quot;\033[0m&quot;;
            break;
        default:
            colorStr = str;
    }
    
    return colorStr;
}

function replaceMetaData(data, values) {
    var finalResult = &quot;&quot;;
    var newData = data;
    for(var n in values) {
        var pattern = new RegExp(&quot;(\/\\*&quot;+n+&quot;\\*\/\&quot;)(.*)(\&quot;;)&quot;, &quot;i&quot;);
        var result = pattern.test(data);
        if (result) {
            finalResult = newData.replace(pattern, &quot;$1&quot;+values[n]+&quot;$3&quot;);
            newData = finalResult;
        } else {
            console.log(setColorText(&quot;Error -- Unable to resolve value:&quot;+ pattern, &quot;red&quot;));
        }
    }
    return finalResult;
}


function exitWithFailure()
{
	process.exit(1);
}

function displayUsage()
{
	print(setColorText(OPTIMIST.help(), &quot;yellow&quot;));
}

function displayTasks()
{
	var out = &quot;Available tasks: &quot;;
	
	for(var _t in TASK)
	{
		out += TASK[_t] +&quot;, &quot;
	}
	
	print(setColorText(out.slice(0, -2), &quot;Cyan&quot;));
}

function taskIsRecognized(task)
{
	return TASK.hasOwnProperty(task);
}

function print(msg)
{
	console.log(msg);
}

//call the main script entry point
main(OPTIMIST.argv);







    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
